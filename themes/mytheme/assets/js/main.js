// Theme toggle functionality
document.addEventListener('DOMContentLoaded', function () {
    const themeToggle = document.getElementById('theme-toggle');
    const themeToggleText = document.getElementById('theme-toggle-text');
    const html = document.documentElement;

    // Get saved theme or default to null (use system preference)
    let currentTheme = localStorage.getItem('theme');

    // Function to update theme toggle text
    function updateToggleText(theme) {
        if (theme === 'dark') {
            themeToggleText.textContent = '☀️';
            themeToggle.setAttribute('aria-label', 'Switch to light theme');
        } else if (theme === 'light') {
            themeToggleText.textContent = '🌙';
            themeToggle.setAttribute('aria-label', 'Switch to dark theme');
        } else {
            // Auto mode - show current effective theme
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            themeToggleText.textContent = prefersDark ? '☀️' : '🌙';
            themeToggle.setAttribute('aria-label', 'Theme: Auto (click to override)');
        }
    }

    // Function to apply theme
    function applyTheme(theme) {
        if (theme) {
            html.setAttribute('data-theme', theme);
        } else {
            html.removeAttribute('data-theme');
        }
        updateToggleText(theme);
    }

    // Apply saved theme on load
    applyTheme(currentTheme);

    // Listen for system theme changes when in auto mode
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function () {
        if (!currentTheme) {
            updateToggleText(null);
        }
    });

    // Theme toggle click handler
    themeToggle.addEventListener('click', function () {
        if (currentTheme === null) {
            // Auto -> Light
            currentTheme = 'light';
        } else if (currentTheme === 'light') {
            // Light -> Dark
            currentTheme = 'dark';
        } else {
            // Dark -> Auto
            currentTheme = null;
        }

        if (currentTheme) {
            localStorage.setItem('theme', currentTheme);
        } else {
            localStorage.removeItem('theme');
        }

        applyTheme(currentTheme);
    });
});

console.log('This site was generated by Hugo.');
